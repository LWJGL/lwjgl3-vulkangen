From d8dd6a25eabd292d81accf29aebc8e549fd0dc40 Mon Sep 17 00:00:00 2001
From: Ioannis Tsakpinis <iotsakp@gmail.com>
Date: Sat, 28 Aug 2021 21:24:50 +0300
Subject: [PATCH] LWJGL fixes

---
 .gitignore                                    | 17 +++++++++-----
 Makefile                                      |  2 +-
 appendices/VK_EXT_debug_report.txt            | 22 -------------------
 appendices/VK_EXT_texel_buffer_alignment.txt  |  1 -
 appendices/VK_INTEL_performance_query.txt     |  2 +-
 .../VK_KHR_pipeline_executable_properties.txt |  1 -
 appendices/VK_KHR_pipeline_library.txt        |  2 +-
 .../VK_NV_device_diagnostics_config.txt       |  2 +-
 .../PresentTimeInfo.txt                       |  2 ++
 .../VK_INTEL_performance_query/queries.txt    | 10 ++++-----
 chapters/VK_KHR_display/display.txt           |  4 ++--
 .../queriesperformance.txt                    |  2 ++
 chapters/VK_KHR_swapchain/wsi.txt             |  6 ++---
 .../platformCreateSurface_macos.txt           | 20 ++++++++---------
 .../indirectcommands.txt                      |  2 +-
 chapters/capabilities.txt                     |  4 +++-
 chapters/features.txt                         | 12 +++++-----
 chapters/formats.txt                          |  4 ++--
 chapters/limits.txt                           |  2 +-
 chapters/memory.txt                           |  2 ++
 chapters/video_decode_extensions.txt          |  1 +
 chapters/video_decode_h265_extensions.txt     |  4 ++++
 chapters/video_encode_extensions.txt          |  2 ++
 makeSpec                                      | 13 +++++++++++
 scripts/extensionmetadocgenerator.py          |  4 ++--
 scripts/reflib.py                             | 14 ++++++++++++
 xml/vk.xml                                    | 14 ++++++------
 27 files changed, 97 insertions(+), 74 deletions(-)

diff --git a/.gitignore b/.gitignore
index 2d6d0e74..1bee2910 100644
--- a/.gitignore
+++ b/.gitignore
@@ -47,13 +47,18 @@ __pycache__
 # Spec build generated, temporary, and output files

 # Files generated from vk.xml
-/gen/
+#/gen/
+/gen/api.py
+/gen/out/
+/gen/refpage/refpage.log
+/gen/spirvcap/
+timeMarker

 # Files generated by extraction from spec source
-man/PFN*.txt
-man/A[A-Z][a-z]*.txt
-man/[Vv][Kk]*.txt
-man/apispec.txt
+#man/PFN*.txt
+#man/A[A-Z][a-z]*.txt
+#man/[Vv][Kk]*.txt
+#man/apispec.txt
 man/logfile
 man/CAMetalLayer.txt
 man/WSIheaders.txt
@@ -74,7 +79,7 @@ xml/diag.txt
 .DS_Store

 # Auto-generated files
-# */timeMarker
+*/timeMarker

 # check_spec_links (and its tests) output
 applyfixes.sh
diff --git a/Makefile b/Makefile
index 1f5fe18f..dc989bde 100644
--- a/Makefile
+++ b/Makefile
@@ -442,7 +442,7 @@ manhtmlpages: $(REFPATH)/apispec.txt $(GENDEPENDS)
 	$(QUIET) echo "manhtmlpages: building HTML refpages with these options:"
 	$(QUIET) echo $(ASCIIDOC) -b html5 $(ADOCOPTS) $(ADOCHTMLOPTS) \
 	    $(ADOCREFOPTS) -d manpage -o REFPAGE.html REFPAGE.txt
-	$(MAKE) $(SUBMAKEOPTIONS) -e buildmanpages
+# $(MAKE) $(SUBMAKEOPTIONS) -e buildmanpages

 # Build the individual refpages, then the symbolic links from aliases
 MANHTMLDIR  = $(OUTDIR)/man/html
diff --git a/appendices/VK_EXT_debug_report.txt b/appendices/VK_EXT_debug_report.txt
index 8a2e6fd2..9f3dc622 100644
--- a/appendices/VK_EXT_debug_report.txt
+++ b/appendices/VK_EXT_debug_report.txt
@@ -91,28 +91,6 @@ happens and the third will log warnings to stdout.
     vkDestroyDebugReportCallbackEXT(instance, cb3);
 ------------------------------------------------------------------------------

-[NOTE]
-.Note
-====
-In the initial release of the `VK_EXT_debug_report` extension, the token
-ename:VK_STRUCTURE_TYPE_DEBUG_REPORT_CREATE_INFO_EXT was used.
-Starting in version 2 of the extension branch,
-ename:VK_STRUCTURE_TYPE_DEBUG_REPORT_CALLBACK_CREATE_INFO_EXT is used
-instead for consistency with Vulkan naming rules.
-The older enum is still available for backwards compatibility.
-====
-
-[NOTE]
-.Note
-====
-In the initial release of the `VK_EXT_debug_report` extension, the token
-ename:VK_DEBUG_REPORT_OBJECT_TYPE_DEBUG_REPORT_EXT was used.
-Starting in version 8 of the extension branch,
-ename:VK_DEBUG_REPORT_OBJECT_TYPE_DEBUG_REPORT_CALLBACK_EXT_EXT is used
-instead for consistency with Vulkan naming rules.
-The older enum is still available for backwards compatibility.
-====
-

 === Issues

diff --git a/appendices/VK_EXT_texel_buffer_alignment.txt b/appendices/VK_EXT_texel_buffer_alignment.txt
index af5ca5a5..8d893c7d 100644
--- a/appendices/VK_EXT_texel_buffer_alignment.txt
+++ b/appendices/VK_EXT_texel_buffer_alignment.txt
@@ -10,7 +10,6 @@ include::{generated}/meta/{refprefix}VK_EXT_texel_buffer_alignment.txt[]
     2019-06-06
 *IP Status*::
     No known IP claims.
-*Interactions and External Dependencies*::
 *Contributors*::
   - Jeff Bolz, NVIDIA

diff --git a/appendices/VK_INTEL_performance_query.txt b/appendices/VK_INTEL_performance_query.txt
index 723710fa..2b31aaf0 100644
--- a/appendices/VK_INTEL_performance_query.txt
+++ b/appendices/VK_INTEL_performance_query.txt
@@ -22,7 +22,7 @@ interpreted by a external application or library.
 Such a library is available at : https://github.com/intel/metrics-discovery

 Performance analysis tools such as
-link:++https://software.intel.com/content/www/us/en/develop/tools/graphics-performance-analyzers.html++[Graphics
+link:https://software.intel.com/content/www/us/en/develop/tools/graphics-performance-analyzers.html[Graphics
 Performance Analyzers] make use of this extension and the metrics-discovery
 library to present the data in a human readable way.

diff --git a/appendices/VK_KHR_pipeline_executable_properties.txt b/appendices/VK_KHR_pipeline_executable_properties.txt
index 0ffbf2e9..93ca249c 100644
--- a/appendices/VK_KHR_pipeline_executable_properties.txt
+++ b/appendices/VK_KHR_pipeline_executable_properties.txt
@@ -10,7 +10,6 @@ include::{generated}/meta/{refprefix}VK_KHR_pipeline_executable_properties.txt[]
     2019-05-28
 *IP Status*::
     No known IP claims.
-*Interactions and External Dependencies*::
 *Contributors*::
   - Jason Ekstrand, Intel
   - Ian Romanick, Intel
diff --git a/appendices/VK_KHR_pipeline_library.txt b/appendices/VK_KHR_pipeline_library.txt
index 1efddca7..54982242 100644
--- a/appendices/VK_KHR_pipeline_library.txt
+++ b/appendices/VK_KHR_pipeline_library.txt
@@ -11,7 +11,7 @@ include::{generated}/meta/{refprefix}VK_KHR_pipeline_library.txt[]
 *IP Status*::
     No known IP claims.
 *Contributors*::
-  - See contributors to `apiext:VK_KHR_ray_tracing`
+  - See contributors to `apiext:VK_KHR_ray_tracing_pipeline`

 === Description

diff --git a/appendices/VK_NV_device_diagnostics_config.txt b/appendices/VK_NV_device_diagnostics_config.txt
index 1bd1d1c2..33a8fc6d 100644
--- a/appendices/VK_NV_device_diagnostics_config.txt
+++ b/appendices/VK_NV_device_diagnostics_config.txt
@@ -14,7 +14,7 @@ include::{generated}/meta/{refprefix}VK_NV_device_diagnostics_config.txt[]

 === Description

-Applications using Nvidia Nsight^(TM)^ Aftermath SDK for Vulkan to integrate
+Applications using Nvidia Nsight(TM) Aftermath SDK for Vulkan to integrate
 device crash dumps into their error reporting mechanisms, may: use this
 extension to configure options related to device crash dump creation.

diff --git a/chapters/VK_GOOGLE_display_timing/PresentTimeInfo.txt b/chapters/VK_GOOGLE_display_timing/PresentTimeInfo.txt
index 72ca7efd..e1f1d713 100644
--- a/chapters/VK_GOOGLE_display_timing/PresentTimeInfo.txt
+++ b/chapters/VK_GOOGLE_display_timing/PresentTimeInfo.txt
@@ -66,4 +66,6 @@ include::{generated}/api/structs/VkPresentTimeGOOGLE.txt[]
     image at any time.
     This is useful when the application desires to provide pname:presentID,
     but does not need a specific pname:desiredPresentTime.
+
+include::{generated}/validity/structs/VkPresentTimeGOOGLE.txt[]
 --
diff --git a/chapters/VK_INTEL_performance_query/queries.txt b/chapters/VK_INTEL_performance_query/queries.txt
index dd06994d..92338f4f 100644
--- a/chapters/VK_INTEL_performance_query/queries.txt
+++ b/chapters/VK_INTEL_performance_query/queries.txt
@@ -123,11 +123,11 @@ The sname:VkPerformanceValueDataINTEL union is defined as:

 include::{generated}/api/structs/VkPerformanceValueDataINTEL.txt[]

-  * pname:data.value32 represents 32-bit integer data.
-  * pname:data.value64 represents 64-bit integer data.
-  * pname:data.valueFloat represents floating-point data.
-  * pname:data.valueBool represents basetype:Bool32 data.
-  * pname:data.valueString represents a pointer to a null-terminated UTF-8
+  * pname:value32 represents 32-bit integer data.
+  * pname:value64 represents 64-bit integer data.
+  * pname:valueFloat represents floating-point data.
+  * pname:valueBool represents basetype:Bool32 data.
+  * pname:valueString represents a pointer to a null-terminated UTF-8
     string.

 The correct member of the union is determined by the associated
diff --git a/chapters/VK_KHR_display/display.txt b/chapters/VK_KHR_display/display.txt
index 8804a252..6a093665 100644
--- a/chapters/VK_KHR_display/display.txt
+++ b/chapters/VK_KHR_display/display.txt
@@ -71,7 +71,7 @@ include::{generated}/api/structs/VkDisplayPropertiesKHR.txt[]
     visible portion of the display, in millimeters.
   * pname:physicalResolution describes the physical, native, or preferred
     resolution of the display.
-
++
 [NOTE]
 .Note
 ====
@@ -90,7 +90,7 @@ should: return the maximum resolution supported.
     self-refresh/internal buffering.
     If this is true, the application can: submit persistent present
     operations on swapchains created against this display.
-
++
 [NOTE]
 .Note
 ====
diff --git a/chapters/VK_KHR_performance_query/queriesperformance.txt b/chapters/VK_KHR_performance_query/queriesperformance.txt
index e834628b..5e567280 100644
--- a/chapters/VK_KHR_performance_query/queriesperformance.txt
+++ b/chapters/VK_KHR_performance_query/queriesperformance.txt
@@ -61,6 +61,8 @@ The slink:VkPerformanceCounterKHR::pname:unit enumeration specifies how to
 parse the counter data.

 include::{generated}/api/structs/VkPerformanceCounterResultKHR.txt[]
+
+include::{generated}/validity/structs/VkPerformanceCounterResultKHR.txt[]
 --


diff --git a/chapters/VK_KHR_swapchain/wsi.txt b/chapters/VK_KHR_swapchain/wsi.txt
index 91b8d88d..7a7fa7bb 100644
--- a/chapters/VK_KHR_swapchain/wsi.txt
+++ b/chapters/VK_KHR_swapchain/wsi.txt
@@ -232,20 +232,20 @@ effects that require them to run for all pixels in the presentable image.
     Providing a valid pname:oldSwapchain may: aid in the resource reuse, and
     also allows the application to still present any images that are already
     acquired from it.
-
++
 Upon calling fname:vkCreateSwapchainKHR with an pname:oldSwapchain that is
 not dlink:VK_NULL_HANDLE, pname:oldSwapchain is retired -- even if creation
 of the new swapchain fails.
 The new swapchain is created in the non-retired state whether or not
 pname:oldSwapchain is dlink:VK_NULL_HANDLE.
-
++
 Upon calling fname:vkCreateSwapchainKHR with an pname:oldSwapchain that is
 not dlink:VK_NULL_HANDLE, any images from pname:oldSwapchain that are not
 acquired by the application may: be freed by the implementation, which may:
 occur even if creation of the new swapchain fails.
 The application can: destroy pname:oldSwapchain to free all memory
 associated with pname:oldSwapchain.
-
++
 [NOTE]
 .Note
 ====
diff --git a/chapters/VK_MVK_macos_surface/platformCreateSurface_macos.txt b/chapters/VK_MVK_macos_surface/platformCreateSurface_macos.txt
index 7072cb2b..977d64b4 100644
--- a/chapters/VK_MVK_macos_surface/platformCreateSurface_macos.txt
+++ b/chapters/VK_MVK_macos_surface/platformCreateSurface_macos.txt
@@ -12,16 +12,6 @@ basetype:CAMetalLayer, call:

 include::{generated}/api/protos/vkCreateMacOSSurfaceMVK.txt[]

-ifdef::VK_EXT_metal_surface[]
-[NOTE]
-.Note
-====
-The `vkCreateMacOSSurfaceMVK` function is considered deprecated and has been
-superseded by flink:vkCreateMetalSurfaceEXT from the
-`<<VK_EXT_metal_surface>>` extension.
-====
-endif::VK_EXT_metal_surface[]
-
   * pname:instance is the instance with which to associate the surface.
   * pname:pCreateInfo is a pointer to a slink:VkMacOSSurfaceCreateInfoMVK
     structure containing parameters affecting the creation of the surface
@@ -32,6 +22,16 @@ endif::VK_EXT_metal_surface[]
   * pname:pSurface is a pointer to a slink:VkSurfaceKHR handle in which the
     created surface object is returned.

+ifdef::VK_EXT_metal_surface[]
+[NOTE]
+.Note
+====
+The `vkCreateMacOSSurfaceMVK` function is considered deprecated and has been
+superseded by flink:vkCreateMetalSurfaceEXT from the
+`<<VK_EXT_metal_surface>>` extension.
+====
+endif::VK_EXT_metal_surface[]
+
 include::{generated}/validity/protos/vkCreateMacOSSurfaceMVK.txt[]
 --

diff --git a/chapters/VK_NV_device_generated_commands/indirectcommands.txt b/chapters/VK_NV_device_generated_commands/indirectcommands.txt
index 36604215..9e8e67ea 100644
--- a/chapters/VK_NV_device_generated_commands/indirectcommands.txt
+++ b/chapters/VK_NV_device_generated_commands/indirectcommands.txt
@@ -103,7 +103,7 @@ include::cmdProcessAllSequences.txt[]
     pname:streamCount must: be greater than `0` and less or equal to
     sname:VkPhysicalDeviceDeviceGeneratedCommandsPropertiesNV::pname:maxIndirectCommandsStreamCount
   * [[VUID-VkIndirectCommandsLayoutCreateInfoNV-pStreamStrides-02937]]
-    each element of pname:pStreamStrides must: be greater than `0`and less
+    each element of pname:pStreamStrides must: be greater than `0` and less
     than or equal to
     sname:VkPhysicalDeviceDeviceGeneratedCommandsPropertiesNV::pname:maxIndirectCommandsStreamStride.
     Furthermore the alignment of each token input must: be ensured
diff --git a/chapters/capabilities.txt b/chapters/capabilities.txt
index 10844ba0..96ac090d 100644
--- a/chapters/capabilities.txt
+++ b/chapters/capabilities.txt
@@ -133,7 +133,7 @@ ifdef::VK_VERSION_1_1,VK_KHR_sampler_ycbcr_conversion[]
      <<formats-requiring-sampler-ycbcr-conversion>>
 endif::VK_VERSION_1_1,VK_KHR_sampler_ycbcr_conversion[]
 ifdef::VK_EXT_image_drm_format_modifier[]
-  * If pname:tiling is ename:VK_IMAGE_TILING_DRM_FORMAT_MODIFIER_EXT, then
+  ** If pname:tiling is ename:VK_IMAGE_TILING_DRM_FORMAT_MODIFIER_EXT, then
     pname:maxArrayLayers must: not be 0.
 endif::VK_EXT_image_drm_format_modifier[]
   * pname:sampleCounts is a bitmask of elink:VkSampleCountFlagBits
@@ -1271,7 +1271,9 @@ following table:
 | ename:VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_OPAQUE_WIN32_KMT_BIT | Must match | Must match
 | ename:VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_D3D12_FENCE_BIT | Must match | Must match
 | ename:VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_SYNC_FD_BIT | No restriction | No restriction
+ifdef::VK_FUCHSIA_external_semaphore[]
 | ename:VK_EXTERNAL_SEMAPHORE_HANDLE_TYPE_ZIRCON_EVENT_BIT_FUCHSIA | No restriction | No restriction
+endif::VK_FUCHSIA_external_semaphore[]
 |====
 --

diff --git a/chapters/features.txt b/chapters/features.txt
index 53da0f7f..cb218311 100644
--- a/chapters/features.txt
+++ b/chapters/features.txt
@@ -1039,8 +1039,7 @@ include::{chapters}/features.txt[tag=VK_KHR_vulkan_memory_model-features]
     from vertex or tessellation evaluation shaders.
     If this feature is not enabled, the code:Layer built-in decoration must:
     not be used on outputs in vertex or tessellation evaluation shaders.
-  * [[features-subgroupBroadcastDynamicId]] If
-    pname:subgroupBroadcastDynamicId is ename:VK_TRUE, the "`Id`" operand of
+  * [[features-subgroupBroadcastDynamicId]] pname:subgroupBroadcastDynamicId if ename:VK_TRUE, the "`Id`" operand of
     code:OpGroupNonUniformBroadcast can: be dynamically uniform within a
     subgroup, and the "`Index`" operand of
     code:OpGroupNonUniformQuadBroadcast can: be dynamically uniform within
@@ -2222,7 +2221,7 @@ This structure describes the following features:

 See <<shaders-scope-quad, Quad shader scope>> for more information.

-:refpage: VkPhysicalDeviceComputeShaderDerivativesFeaturesNVfeatures.
+:refpage: VkPhysicalDeviceComputeShaderDerivativesFeaturesNV
 include::{chapters}/features.txt[tag=features]

 include::{generated}/validity/structs/VkPhysicalDeviceComputeShaderDerivativesFeaturesNV.txt[]
@@ -2901,7 +2900,7 @@ This structure describes the following feature:
     indicates that the implementation supports the
     code:IntegerFunctions2INTEL SPIR-V capability.

-:refpage: VkPhysicalDeviceShaderIntegerFunctions2FeaturesINTELfeatures.
+:refpage: VkPhysicalDeviceShaderIntegerFunctions2FeaturesINTEL
 include::{chapters}/features.txt[tag=features]

 include::{generated}/validity/structs/VkPhysicalDeviceShaderIntegerFunctions2FeaturesINTEL.txt[]
@@ -3997,14 +3996,15 @@ This structure describes the following feature:
     that the implementation must: support using the elink:VkDescriptorType
     of ename:VK_DESCRIPTOR_TYPE_MUTABLE_VALVE with at least the following
     descriptor types, where any combination of the types must: be supported:
++
   ** ename:VK_DESCRIPTOR_TYPE_SAMPLED_IMAGE
   ** ename:VK_DESCRIPTOR_TYPE_STORAGE_IMAGE
   ** ename:VK_DESCRIPTOR_TYPE_UNIFORM_TEXEL_BUFFER
   ** ename:VK_DESCRIPTOR_TYPE_STORAGE_TEXEL_BUFFER
   ** ename:VK_DESCRIPTOR_TYPE_UNIFORM_BUFFER
   ** ename:VK_DESCRIPTOR_TYPE_STORAGE_BUFFER
-
-  * Additionally, pname:mutableDescriptorType indicates that:
++
+Additionally, pname:mutableDescriptorType indicates that:
 ifdef::VK_VERSION_1_2,VK_EXT_descriptor_indexing[]
   ** Non-uniform descriptor indexing must: be supported if all descriptor
      types in a slink:VkMutableDescriptorTypeListVALVE for
diff --git a/chapters/formats.txt b/chapters/formats.txt
index e50b7bdb..424e599e 100644
--- a/chapters/formats.txt
+++ b/chapters/formats.txt
@@ -2703,8 +2703,8 @@ pname:drmFormatModifierPlaneCount) is distinct from its _format planecount_
 (in the sense of <<formats-requiring-sampler-ycbcr-conversion,multi-planar>>
 {YCbCr} formats).
 In tlink:VkImageAspectFlags, each
-etext:VK_IMAGE_ASPECT_MEMORY_PLANE___i___BIT_EXT represents a _memory plane_
-and each etext:VK_IMAGE_ASPECT_PLANE___i___BIT a _format plane_.
+etext:VK_IMAGE_ASPECT_MEMORY_PLANE_i_BIT_EXT represents a _memory plane_
+and each etext:VK_IMAGE_ASPECT_PLANE_i_BIT a _format plane_.

 An image's set of _format planes_ is an ordered partition of the image's
 *content* into separable groups of format channels.
diff --git a/chapters/limits.txt b/chapters/limits.txt
index f8b738d1..7c37c304 100644
--- a/chapters/limits.txt
+++ b/chapters/limits.txt
@@ -1272,7 +1272,7 @@ ifndef::VK_VERSION_1_2[:anchor-prefix:]
 include::{chapters}/limits.txt[tag=limits_desc]

 If pname:supportedOperations includes <<features-subgroup-quad,
-ename:VK_SUBGROUP_FEATURE_QUAD_BIT,>>
+ename:VK_SUBGROUP_FEATURE_QUAD_BIT>>,
 ifdef::VK_KHR_shader_subgroup_uniform_control_flow[]
 or <<features-shaderSubgroupUniformControlFlow,
 pname:shaderSubgroupUniformControlFlow>> is enabled,
diff --git a/chapters/memory.txt b/chapters/memory.txt
index 310fe58e..e26b3d78 100644
--- a/chapters/memory.txt
+++ b/chapters/memory.txt
@@ -230,6 +230,8 @@ include::{generated}/api/funcpointers/PFN_vkInternalFreeNotification.txt[]
   * pname:allocationScope is a elink:VkSystemAllocationScope value
     specifying the allocation scope of the lifetime of the allocation, as
     described <<memory-host-allocation-scope,here>>.
+
+This is a purely informational callback.
 --

 [open,refpage='VkSystemAllocationScope',desc='Allocation scope',type='enums',xrefs='VkAllocationCallbacks']
diff --git a/chapters/video_decode_extensions.txt b/chapters/video_decode_extensions.txt
index 31178baa..005533b7 100644
--- a/chapters/video_decode_extensions.txt
+++ b/chapters/video_decode_extensions.txt
@@ -273,6 +273,7 @@ include::{generated}/validity/protos/vkCmdDecodeVideoKHR.txt[]
 The slink:VkVideoDecodeInfoKHR structure is defined as:

 include::{generated}/api/structs/VkVideoDecodeInfoKHR.txt[]
+
   * pname:sType is the type of this structure.
   * pname:pNext is `NULL` or a pointer to a structure extending this
     structure.
diff --git a/chapters/video_decode_h265_extensions.txt b/chapters/video_decode_h265_extensions.txt
index a0432713..47e3cc05 100644
--- a/chapters/video_decode_h265_extensions.txt
+++ b/chapters/video_decode_h265_extensions.txt
@@ -68,6 +68,7 @@ capabilities.
 The slink:VkVideoDecodeH265CapabilitiesEXT structure is defined as:

 include::{generated}/api/structs/VkVideoDecodeH265CapabilitiesEXT.txt[]
+
   * pname:sType is the type of this structure.
   * pname:pNext is `NULL` or a pointer to a structure extending this
     structure.
@@ -92,6 +93,7 @@ decode operations.
 The slink:VkVideoDecodeH265SessionCreateInfoEXT structure is defined as:

 include::{generated}/api/structs/VkVideoDecodeH265SessionCreateInfoEXT.txt[]
+
   * pname:sType is the type of this structure.
   * pname:pNext is `NULL` or a pointer to a structure extending this
     structure.
@@ -214,6 +216,7 @@ include::{generated}/validity/structs/VkVideoDecodeH265SessionParametersAddInfoE
 The slink:VkVideoDecodeH265PictureInfoEXT structure is defined as:

 include::{generated}/api/structs/VkVideoDecodeH265PictureInfoEXT.txt[]
+
   * pname:sType is the type of this structure.
   * pname:pNext is `NULL` or a pointer to a structure extending this
     structure.
@@ -233,6 +236,7 @@ include::{generated}/validity/structs/VkVideoDecodeH265PictureInfoEXT.txt[]
 The slink:VkVideoDecodeH265DpbSlotInfoEXT structure is defined as:

 include::{generated}/api/structs/VkVideoDecodeH265DpbSlotInfoEXT.txt[]
+
   * pname:sType is the type of this structure.
   * pname:pNext is `NULL` or a pointer to a structure extending this
     structure.
diff --git a/chapters/video_encode_extensions.txt b/chapters/video_encode_extensions.txt
index 71833170..c8a9bd75 100644
--- a/chapters/video_encode_extensions.txt
+++ b/chapters/video_encode_extensions.txt
@@ -133,6 +133,7 @@ include::{generated}/validity/protos/vkCmdEncodeVideoKHR.txt[]
 The slink:VkVideoEncodeInfoKHR structure is defined as:

 include::{generated}/api/structs/VkVideoEncodeInfoKHR.txt[]
+
   * pname:sType is the type of this structure.
   * pname:pNext is a pointer to a structure extending this structure.
     A codec-specific extension structure must: be chained to specify what
@@ -219,6 +220,7 @@ more elink:VkVideoEncodeFlagBitsKHR.
 The slink:VkVideoEncodeRateControlInfoKHR structure is defined as:

 include::{generated}/api/structs/VkVideoEncodeRateControlInfoKHR.txt[]
+
   * pname:sType is the type of this structure.
   * pname:pNext is `NULL` or a pointer to a structure extending this
     structure.
diff --git a/makeSpec b/makeSpec
index 7a3add3f..4b2af6c7 100755
--- a/makeSpec
+++ b/makeSpec
@@ -72,6 +72,19 @@ if __name__ == '__main__':
         title = 'with all registered extensions'
         exts = set(allExts)

+    exts.remove('VK_ANDROID_external_memory_android_hardware_buffer')
+    exts.remove('VK_EXT_directfb_surface')
+    exts.remove('VK_FUCHSIA_imagepipe_surface')
+    exts.remove('VK_FUCHSIA_external_memory')
+    exts.remove('VK_FUCHSIA_external_semaphore')
+    exts.remove('VK_GGP_frame_token')
+    exts.remove('VK_GGP_stream_descriptor_surface')
+    exts.remove('VK_KHR_android_surface')
+    exts.remove('VK_KHR_xcb_surface')
+    exts.remove('VK_MVK_ios_surface')
+    exts.remove('VK_NN_vi_surface')
+    exts.remove('VK_QNX_screen_surface')
+
     # List of explicitly requested extension and all its dependencies
     extraexts = set()
     for name in results.extension:
diff --git a/scripts/extensionmetadocgenerator.py b/scripts/extensionmetadocgenerator.py
index 2f5810ec..112fe9c8 100644
--- a/scripts/extensionmetadocgenerator.py
+++ b/scripts/extensionmetadocgenerator.py
@@ -263,12 +263,12 @@ class Extension:
                 write('  * Requires', self.conventions.formatExtension(dep),
                       file=fp)
         if self.provisional == 'true':
-            write('  * *This is a _provisional_ extension and must: be used with caution.', file=fp)
+            write('  * This is a _provisional_ extension and must: be used with caution.', file=fp)
             write('    See the ' +
                   self.specLink(xrefName = 'boilerplate-provisional-header',
                                 xrefText = 'description',
                                 isRefpage = isRefpage) +
-                  ' of provisional header files for enablement and stability details.*', file=fp)
+                  ' of provisional header files for enablement and stability details.', file=fp)
         write('', file=fp)

         if self.deprecationType:
diff --git a/scripts/reflib.py b/scripts/reflib.py
index 5eaf5e79..2f6ec331 100644
--- a/scripts/reflib.py
+++ b/scripts/reflib.py
@@ -219,6 +219,11 @@ def nextPara(file, line):
     maxLine = len(file) - 1
     # Skip over current paragraph
     while (line != maxLine and not isempty(file[line])):
+        # LWJGL: Skip note blocks (may contain empty lines)
+        if (file[line] == '====\n'):
+            line = line + 1
+            while (line != maxLine and file[line] != '====\n'):
+                line = line + 1
         line = line + 1
     # Skip over white space
     while (line != maxLine and isempty(file[line])):
@@ -262,6 +267,10 @@ def clampToBlock(line, minline, maxline):

     return line

+# LWJGL: body/Description block detection
+regexListItem = re.compile('^(?:[/]|\s+[^/])')
+regexAnchorPrefix = re.compile('^:anchor-prefix:$')
+
 def fixupRefs(pageMap, specFile, file):
     """Fill in missing fields in pageInfo structures, to the extent they can be
     inferred.
@@ -319,6 +328,11 @@ def fixupRefs(pageMap, specFile, file):
                 pi.param = nextPara(file, pi.include)
                 if pi.body is None:
                     pi.body = nextPara(file, pi.param)
+                    # LWJGL: body/Description block detection
+                    while regexListItem.match(file[pi.body]):
+                        pi.body = nextPara(file, pi.body)
+                    if regexAnchorPrefix.match(file[pi.body]):
+                        pi.body = nextPara(file, pi.body)
             else:
                 if pi.body is None:
                     pi.body = nextPara(file, pi.include)
diff --git a/xml/vk.xml b/xml/vk.xml
index 50d55cda..78e62321 100644
--- a/xml/vk.xml
+++ b/xml/vk.xml
@@ -224,7 +224,7 @@ typedef void <name>CAMetalLayer</name>;
         <type requires="vk_platform" name="int32_t"/>
         <type requires="vk_platform" name="int64_t"/>
         <type requires="vk_platform" name="size_t"/>
-        <type name="int"/>
+        <type requires="vk_platform" name="int"/>

             <comment>Bitmask types</comment>
         <type requires="VkFramebufferCreateFlagBits"      category="bitmask">typedef <type>VkFlags</type> <name>VkFramebufferCreateFlags</name>;</type>
@@ -900,9 +900,9 @@ typedef void <name>CAMetalLayer</name>;
         </type>
         <type category="struct" name="VkPhysicalDeviceMemoryProperties" returnedonly="true">
             <member><type>uint32_t</type>               <name>memoryTypeCount</name></member>
-            <member><type>VkMemoryType</type>           <name>memoryTypes</name>[<enum>VK_MAX_MEMORY_TYPES</enum>]</member>
+            <member len="memoryTypeCount"><type>VkMemoryType</type>           <name>memoryTypes</name>[<enum>VK_MAX_MEMORY_TYPES</enum>]</member>
             <member><type>uint32_t</type>               <name>memoryHeapCount</name></member>
-            <member><type>VkMemoryHeap</type>           <name>memoryHeaps</name>[<enum>VK_MAX_MEMORY_HEAPS</enum>]</member>
+            <member len="memoryHeapCount"><type>VkMemoryHeap</type>           <name>memoryHeaps</name>[<enum>VK_MAX_MEMORY_HEAPS</enum>]</member>
         </type>
         <type category="struct" name="VkMemoryAllocateInfo">
             <member values="VK_STRUCTURE_TYPE_MEMORY_ALLOCATE_INFO"><type>VkStructureType</type> <name>sType</name></member>
@@ -4088,7 +4088,7 @@ typedef void <name>CAMetalLayer</name>;
         <type category="struct" name="VkAccelerationStructureInfoNV">
             <member values="VK_STRUCTURE_TYPE_ACCELERATION_STRUCTURE_INFO_NV"><type>VkStructureType</type> <name>sType</name></member>
             <member optional="true">const <type>void</type>*                            <name>pNext</name></member>
-            <member><type>VkAccelerationStructureTypeNV</type>         <name>type</name></member>
+            <member><type>VkAccelerationStructureTypeKHR</type>         <name>type</name></member>
             <member optional="true"><type>VkBuildAccelerationStructureFlagsNV</type><name>flags</name></member>
             <member optional="true"><type>uint32_t</type>               <name>instanceCount</name></member>
             <member optional="true"><type>uint32_t</type>               <name>geometryCount</name></member>
@@ -12903,7 +12903,7 @@ typedef void <name>CAMetalLayer</name>;
             </require>
             <require extension="VK_KHR_descriptor_update_template">
                 <command name="vkCmdPushDescriptorSetWithTemplateKHR"/>
-                <enum value="1" extends="VkDescriptorUpdateTemplateType"    name="VK_DESCRIPTOR_UPDATE_TEMPLATE_TYPE_PUSH_DESCRIPTORS_KHR" comment="Create descriptor update template for pushed descriptor updates"/>
+                <!--<enum value="1" extends="VkDescriptorUpdateTemplateType"    name="VK_DESCRIPTOR_UPDATE_TEMPLATE_TYPE_PUSH_DESCRIPTORS_KHR" comment="Create descriptor update template for pushed descriptor updates"/>-->
             </require>
         </extension>
         <extension name="VK_EXT_conditional_rendering" number="82" type="device" author="NV" contact="Vikram Kushwaha @vkushwaha" supported="vulkan">
@@ -15051,10 +15051,10 @@ typedef void <name>CAMetalLayer</name>;
                 <command                                                    name="vkGetPhysicalDeviceToolPropertiesEXT"/>
             </require>
             <require extension="VK_EXT_debug_report">
-                <enum bitpos="5" extends="VkToolPurposeFlagBitsEXT"         name="VK_TOOL_PURPOSE_DEBUG_REPORTING_BIT_EXT"/>
+                <!--<enum bitpos="5" extends="VkToolPurposeFlagBitsEXT"         name="VK_TOOL_PURPOSE_DEBUG_REPORTING_BIT_EXT"/>-->
             </require>
             <require extension="VK_EXT_debug_marker">
-                <enum bitpos="6" extends="VkToolPurposeFlagBitsEXT"         name="VK_TOOL_PURPOSE_DEBUG_MARKERS_BIT_EXT"/>
+                <!--<enum bitpos="6" extends="VkToolPurposeFlagBitsEXT"         name="VK_TOOL_PURPOSE_DEBUG_MARKERS_BIT_EXT"/>-->
             </require>
             <require extension="VK_EXT_debug_utils">
                 <enum bitpos="5" extends="VkToolPurposeFlagBitsEXT"         name="VK_TOOL_PURPOSE_DEBUG_REPORTING_BIT_EXT"/>
--
2.30.2.windows.1
